theme(
legend.position = "none",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_4()
#---- Analysis 6.3 - Examine the distribution of terminated employees across different business units ----
Q6_3 <- function() {
# Filter data for terminated employees
terminated_employees <- data %>% filter(status == "TERMINATED")
# Create a violin plot for business unit distribution
ggplot(terminated_employees, aes(x = business_unit, y = age, fill = business_unit)) +
geom_violin(trim = FALSE) +
scale_fill_discrete(guide = FALSE) +
labs(x = "Business Unit", y = "Age", title = "Distribution of Terminated Employees Across Business Units") +
theme_minimal() +
theme(legend.position = "none")
}
Q6_3()
#---- Analysis 6.2 - Identify the cities or store locations with the highest number of terminated employees. ----
Q6_2 <- function() {
# Filter data for terminated employees
terminated_employees <- data %>%
filter(status == "TERMINATED")
# Calculate the count of terminated employees by city and store location
termination_counts <- terminated_employees %>%
count(city_name, store_name)
# Sort the termination counts in descending order
termination_counts <- termination_counts %>%
arrange(desc(n))
# Create bar plot
ggplot(termination_counts, aes(x = reorder(city_name, -n), y = n, fill = store_name)) +
geom_bar(stat = "identity") +
labs(x = "City", y = "Termination Count", title = "Cities with Highest Number of Terminated Employees") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "top")
}
Q6_2()
#---- Analysis 6.1 - Analyze the termination rate in different cities and store name ----
Q6_1 <- function() {
# Filter data for terminated employees
terminated_employees <- data %>%
filter(status == "TERMINATED")
# Calculate termination rate and count by city and store location
termination_data <- terminated_employees %>%
group_by(city_name, store_name) %>%
summarize(termination_rate = n() / nrow(data),
termination_count = n(), .groups = 'drop')
# Create bubble plot
ggplot(termination_data, aes(x = city_name, y = store_name, size = termination_count, fill = termination_rate)) +
geom_point(shape = 21, color = "black") +
scale_size_continuous(range = c(2, 10)) +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
labs(x = "City", y = "Store Name", title = "Termination Rate in Different Cities and Store Locations") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q6_1()
Q6_5 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a strip plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate)) +
geom_jitter(color = "#3399FF", size = 3, width = 0.2) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.position = "none",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_5()
Q6_5 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a box plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate)) +
geom_boxplot(fill = "#3399FF", color = "grey", alpha = 0.7) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.position = "none",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_5()
Q6_5 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a density plot
ggplot(termination_rates, aes(x = termination_rate, fill = termination_year)) +
geom_density(alpha = 0.7) +
labs(x = "Termination Rate", y = "Density", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_5()
warnings()
Q6_5 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_count, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Count", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_5()
#---- Analysis 6.6 - Analyse the trend of employee termination rates over time for Nanaimo city ----
Q6_6 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Count", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_6()
Q6_6 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_6()
Q6_6 <- function() {
city <- "Nanaimo"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific city
terminated_employees <- data %>%
filter(status == "TERMINATED" & city_name == city)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", city)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_6()
#---- Analysis 6.7 - Analyse the trend of employee termination rates over time for Nanaimo city ----
Q6_7 <- function() {
unit <- "HEADOFFICE"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & business_unit == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a line plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, color = termination_year)) +
geom_line() +
geom_point(size = 3) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", unit)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_7()
Q6_7 <- function() {
unit <- "STORES"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & business_unit == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a line plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, color = termination_year)) +
geom_line() +
geom_point(size = 3) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", unit)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_7()
#---- Analysis 6.3 - Examine the distribution of terminated employees across different business units ----
Q6_3 <- function() {
# Filter data for terminated employees
terminated_employees <- data %>% filter(status == "TERMINATED")
# Create a violin plot for business unit distribution
ggplot(terminated_employees, aes(x = business_unit, y = age, fill = business_unit)) +
geom_violin(trim = FALSE) +
scale_fill_discrete(guide = FALSE) +
labs(x = "Business Unit", y = "Age", title = "Distribution of Terminated Employees Across Business Units") +
theme_minimal() +
theme(legend.position = "none")
}
Q6_3()
#---- Analysis 6.1 - Analyze the termination rate in different cities and store name ----
Q6_1 <- function() {
# Filter data for terminated employees
terminated_employees <- data %>%
filter(status == "TERMINATED")
# Calculate termination rate and count by city and store location
termination_data <- terminated_employees %>%
group_by(city_name, store_name) %>%
summarize(termination_rate = n() / nrow(data),
termination_count = n(), .groups = 'drop')
# Create bubble plot
ggplot(termination_data, aes(x = city_name, y = store_name, size = termination_count, fill = termination_rate)) +
geom_point(shape = 21, color = "black") +
scale_size_continuous(range = c(2, 10)) +
scale_fill_gradient(low = "lightblue", high = "darkblue") +
labs(x = "City", y = "Store Name", title = "Termination Rate in Different Cities and Store Locations") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q6_1()
Q6_8 <- function() {
unit <- "35"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a line plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, color = termination_year)) +
geom_line() +
geom_point(size = 3) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for", unit)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_8()
Q6_8 <- function() {
unit <- "35"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for Store", unit)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_8()
Q6_8 <- function() {
unit <- "37"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a stacked bar chart with custom colors
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", width = 0.7, color = "black") +
scale_fill_manual(values = c("#F9C74F", "#90BE6D", "#F94144")) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for Store", unit)) +
theme_classic() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_8()
Q6_8 <- function() {
unit <- "37"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a stacked bar chart with custom colors
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", width = 0.7, color = "black") +
scale_fill_manual(values = c("#F9C74F", "#90BE6D", "#F94144", "#F8961E", "#8CCE3F", "#4D4D4D", "#3D405B", "#FFC107", "#5E35B1", "#EC407A")) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for Store", unit)) +
theme_classic() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_8()
#---- Analysis 7.1 - Analyze the proportion of different generations within each department. ----
Q7_1 <- function() {
# Subset data
generation_dept <- data[, c("department_name", "generation")]
# Calculate proportion of each generation within each department
generation_prop <- prop.table(table(generation_dept$department_name, generation_dept$generation), margin = 1)
# Create bar plot
ggplot(generation_prop, aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity") +
labs(x = "Department", y = "Proportion", fill = "Generation") +
ggtitle("Proportion of Generations within Each Department") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
Q7_1 <- function() {
# Subset data
generation_dept <- data[, c("department_name", "generation")]
# Calculate proportion of each generation within each department
generation_prop <- prop.table(table(generation_dept$department_name, generation_dept$generation), margin = 1)
# Create bar plot
ggplot(generation_prop, aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity") +
labs(x = "Department", y = "Proportion", fill = "Generation") +
ggtitle("Proportion of Generations within Each Department") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
}
Q7_1()
#---- Analysis 6.9 - Exploring the Trend of Employee Termination Rates over Time for Store 37 ----
Q6_9 <- function() {
unit <- "37"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a stacked bar chart with custom colors
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", width = 0.7, color = "black") +
scale_fill_manual(values = c("#F9C74F", "#90BE6D", "#F94144", "#F8961E", "#8CCE3F",
"#4D4D4D", "#3D405B", "#FFC107", "#5E35B1", "#EC407A")) +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for Store", unit)) +
theme_classic() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_9()
#---- Analysis 6.8 - Analysis of Employee Termination Rate Trends Over Time for Store 35 ----
Q6_8 <- function() {
unit <- "35"
data$termination_year <- format(data$termination_date, "%Y")
# Filter data for terminated employees in the specific business_unit
terminated_employees <- data %>%
filter(status == "TERMINATED" & store_name == unit)
# Calculate the termination rates by year
termination_rates <- terminated_employees %>%
group_by(termination_year) %>%
summarize(termination_count = n()) %>%
mutate(termination_rate = termination_count / sum(termination_count))
# Create a bar plot
ggplot(termination_rates, aes(x = termination_year, y = termination_rate, fill = termination_year)) +
geom_bar(stat="identity", position = "dodge", color = "black") +
labs(x = "Termination Year", y = "Termination Rate", title = paste("Termination Rate Trend for Store", unit)) +
theme_minimal() +
theme(
legend.title = element_blank(),
legend.position = "bottom",
axis.title = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5)
)
}
Q6_8()
