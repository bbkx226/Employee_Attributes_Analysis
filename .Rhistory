ggplot(data_pct, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation")
}
Q4_2()
Q4_2 <- function() {
# Filter data for employees before and after year 2013
data_pct <- data %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the stacked bar chart
ggplot(data_pct, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation")
}
Q4_2()
Q4_2 <- function() {
# Filter data for employees before and after year 2013
data_filtered <- data %>%
mutate(before_2013 = ifelse(status_year < 2013, "Before 2013", "After 2013"))
# Calculate percentage of employees by department and generation
data_pct <- data_filtered %>%
group_by(department_name, generation, before_2013) %>%
summarise(n = n()) %>%
ungroup() %>%
mutate(pct = n / sum(n) * 100)
# Plot a stacked bar chart
ggplot(data_pct, aes(x = department_name, y = pct, fill = generation)) +
geom_col(position = "stack", width = 0.6, alpha = 0.9) +
facet_wrap(~ before_2013, ncol = 2) +
labs(x = "Department",
y = "Percentage of Employees",
fill = "Generation") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321",
"Gen X" = "#0F2199",
"Millennials" = "#AF3376")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
plot.title = element_text(size = 20, face = "bold", hjust = 0.5),
strip.text = element_text(size = 16, face = "bold")) +
ggtitle("Employees' Job by Generation and Year") +
geom_text(aes(label = paste0(round(pct), "%")),
position = position_stack(vjust = 0.5),
size = 4, color = "white", fontface = "bold")
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013) %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013) %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the stacked bar chart
plot_before_2013 <- ggplot(data_before_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation")
plot_after_2013 <- ggplot(data_after_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the stacked bar chart
plot_before_2013 <- ggplot(data_before_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013")
plot_after_2013 <- ggplot(data_after_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_1 <- function() {
termination_count <- data %>%
filter(status == "TERMINATED", status_year >= 2013) %>%
group_by(department_name, status_year) %>%
summarise(count = n(), .groups = "drop")
# Plot grouped bar chart
ggplot(termination_count, aes(x = reorder(department_name, -count), y = count)) +
geom_col(aes(fill = factor(status_year))) +
labs(x = "Department",
y = "Number of Terminated Employees",
fill = "Year") +
scale_fill_manual(values = c("2013" = "#DD4321",
"2014" = "#0F2199",
"2015" = "#AF3376")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Terminated Employees' Job after year 2013")
}
Q4_1()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the stacked bar chart
plot_before_2013 <- ggplot(data_before_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013")
plot_after_2013 <- ggplot(data_after_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the stacked bar chart
plot_before_2013 <- ggplot(data_before_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013")
plot_after_2013 <- ggplot(data_after_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "stack") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Create the grouped bar chart
plot_before_2013 <- ggplot(data_before_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321",
"Gen X" = "#0F2199",
"Millennials" = "#AF3376")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013")
plot_after_2013 <- ggplot(data_after_2013, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321",
"Gen X" = "#0F2199",
"Millennials" = "#AF3376")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013")
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013")
grid.arrange(plot_before_2013, plot_after_2013, ncol = 2)
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart with a custom color palette
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
}
Q4_2()
#---- Analysis 4.2 - Determine the termination reason of different generation employees after 2013 ----
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart with a custom color palette
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
}
Q4_2()
#---- Analysis 4.2 - Determine the termination reason of different generation employees after 2013 ----
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation)) %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart with a custom color palette
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
}
Q4_2()
#---- Analysis 4.2 - Determine the termination reason of different generation employees after 2013 ----
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n()) %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation), .groups = 'drop') %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation), .groups = 'drop') %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart with a custom color palette
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
}
Q4_2()
Q4_2 <- function() {
data_after_2013 <- data %>%
filter(status_year >= 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n(), .groups = 'drop') %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
data_before_2013 <- data %>%
filter(status_year < 2013, status == "ACTIVE") %>%
group_by(department_name, generation) %>%
summarize(count = n(), .groups = 'drop') %>%
group_by(department_name) %>%
mutate(pct = count / sum(count) * 100)
# Filter for departments with more than two generations
data_before_2013_filtered <- data_before_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation), .groups = 'drop') %>%
filter(num_generations > 2) %>%
select(department_name)
data_after_2013_filtered <- data_after_2013 %>%
group_by(department_name) %>%
summarize(num_generations = n_distinct(generation), .groups = 'drop') %>%
filter(num_generations > 2) %>%
select(department_name)
data_before_2013_filtered <- semi_join(data_before_2013, data_before_2013_filtered, by = "department_name")
data_after_2013_filtered <- semi_join(data_after_2013, data_after_2013_filtered, by = "department_name")
# Create the grouped bar chart with a custom color palette
plot_before_2013 <- ggplot(data_before_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation before year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
plot_after_2013 <- ggplot(data_after_2013_filtered, aes(x = department_name, y = pct, fill = generation)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#FDB813", "#00A6ED", "#E21F5D", "#1F9433")) +
labs(x = "Department", y = "Percentage of Employees", fill = "Generation") +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12)) +
ggtitle("Percentage of Employees in Each Department by Generation after year 2013") +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 12),
axis.title.y = element_text(size = 14, face = "bold"),
axis.title.x = element_text(size = 14, face = "bold"))
}
Q4_2()
