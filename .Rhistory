facet_wrap(~ gender) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_2()
# Explanation:
# Based on the analysis, it was found that the job role with the highest number of employees above the age of 60, for both male and female, was meat cutter.
# However, it was observed that a higher number of female employees had left the job compared to male employees.
# One possible explanation for this trend could be that the physical demands of the job, which require stamina and strength, become more challenging for female employees with increasing age,
# resulting in a higher likelihood of termination.
Q3_2 <- function() {
data_filtered <- data %>%
filter(age >= 60) %>%
group_by(gender, job_title, status) %>%
summarise(count = n(), .groups = "drop")
ggplot(data_filtered, aes(x = job_title, y = count, fill = status)) +
geom_bar(stat = "identity", position = "stack", color = "white", size = 0.2) +
labs(x = "Job Title", y = "Count of Terminated Employees", fill = "Status") +
facet_wrap(~ gender) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_2()
Q3_2 <- function() {
data_filtered <- data %>%
filter(age >= 60) %>%
group_by(gender, job_title, status) %>%
summarise(count = n(), .groups = "drop")
ggplot(data_filtered, aes(x = job_title, y = count, fill = status)) +
geom_bar(stat = "identity", position = "stack", color = "white", size = 0.2) +
labs(x = "Job Title", y = "Count of Terminated Employees", fill = "Status") +
facet_wrap(~ gender) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_2()
Q3_2 <- function() {
data_filtered <- data %>%
filter(age >= 60) %>%
group_by(gender, job_title, status) %>%
summarise(count = n(), .groups = "drop")
ggplot(data_filtered, aes(x = job_title, y = count, fill = status)) +
geom_bar(stat = "identity", position = "stack", color = "white", size = 0.4) +
labs(x = "Job Title", y = "Count of Terminated Employees", fill = "Status") +
facet_wrap(~ gender) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_2()
#---- Analysis 3.3 - Find the relationship between city and employees' termination ----
Q3_3 <- function() {
# Filter the data that only applicable for those who terminated in 2014 & 2015
data$record_year <- year(ymd(data$record_date))
data_filtered <- data %>%
filter(status == "TERMINATED", record_year %in% c(2014, 2015))
# Counting terminated employees by gender and city
terminated_by_city <- data_filtered %>%
group_by(gender, city_name) %>%
summarise(count = n(), .groups = "drop")
# Plotting the graph
ggplot(terminated_by_city, aes(x = city_name, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "City", y = "Count of Terminated Employees", fill = "Gender") +
ggtitle("Distribution of Terminated Employees by City and Gender") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_3()
# Explanation:
# According to the graph, Vancouver had the highest number of terminated female employees.
# This may be attributed to a possible decline in the industries where female employees were more represented in Vancouver, resulting in higher termination rates.
Q3_1 = function() {
# Filter out the year of termination date
data$termination_year <- year(ymd(data$termination_date))
# Filter the data that only applicable for those who terminated in 2014 & 2015
data_2014_2015 <- data %>%
filter(termination_year %in% c(2014, 2015), status == "TERMINATED")
# Create the histogram for females
female_data <- subset(data_2014_2015, gender == "Female")
female_hist <- ggplot(female_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Female Employee Termination by Age and Reason",
x = "Age",
y = "Frequency")
# Create the histogram for males
male_data <- subset(data_2014_2015, gender == "Male")
male_hist <- ggplot(male_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Male Employee Termination by Age and Reason",
x = "Age", y = "Frequency")
# Combine the histograms to show them all in a graph
grid.arrange(female_hist, male_hist, ncol = 2)
}
Q3_1()
Q3_1 = function() {
# Filter out the year of termination date
data$termination_year <- year(ymd(data$termination_date))
# Filter the data that only applicable for those who terminated in 2014 & 2015
data_2014_2015 <- data %>%
filter(termination_year %in% c(2014, 2015), status == "TERMINATED")
# Create the histogram for females
female_data <- subset(data_2014_2015, gender == "Female")
female_hist <- ggplot(female_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Female Employee Termination by Age and Reason",
x = "Age",
y = "Frequency")
# Create the histogram for males
male_data <- subset(data_2014_2015, gender == "Male")
male_hist <- ggplot(male_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Male Employee Termination by Age and Reason",
x = "Age", y = "Frequency")
# Combine the histograms to show them all in a graph
grid.arrange(female_hist, male_hist, ncol = 2)
}
Q3_1()
Q3_3 <- function() {
# Filter the data that only applicable for those who terminated in 2014 & 2015
data$termination_year <- year(ymd(data$termination_date))
data_filtered <- data %>%
filter(status == "TERMINATED", termination_year %in% c(2014, 2015))
# Counting terminated employees by gender and city
terminated_by_city <- data_filtered %>%
group_by(gender, city_name) %>%
summarise(count = n(), .groups = "drop")
# Plotting the graph
ggplot(terminated_by_city, aes(x = city_name, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "City", y = "Count of Terminated Employees", fill = "Gender") +
ggtitle("Distribution of Terminated Employees by City and Gender") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_3()
Q3_3 <- function() {
# Filter out the year of termination date
data$termination_year <- year(ymd(data$termination_date))
# Filter the data that only applicable for those who terminated in 2014 & 2015
data_filtered <- data %>%
filter(status == "TERMINATED", termination_year %in% c(2014, 2015))
# Counting terminated employees by gender and city
terminated_by_city <- data_filtered %>%
group_by(gender, city_name) %>%
summarise(count = n(), .groups = "drop")
# Plotting the graph
ggplot(terminated_by_city, aes(x = city_name, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "City", y = "Count of Terminated Employees", fill = "Gender") +
ggtitle("Distribution of Terminated Employees by City and Gender") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_3()
#---- Analysis 3.4 - Identify the job roles with the highest number of female employees in the city, Vancouver ----
Q3_4 <- function() {
# Filter data for Vancouver and group by gender and job title
data_filtered <- data %>%
filter(city_name == "Vancouver", gender == "Female") %>%
group_by(gender, job_title) %>%
summarise(count = n(), .groups = "drop")
# Order job titles by descending count
data_filtered <- data_filtered %>%
arrange(desc(count))
# Plot stacked bar chart
ggplot(data_filtered, aes(x = job_title, y = count, fill = gender)) +
geom_bar(stat = "identity") +
labs(x = "Jobs in Vancouver city", y = "Number of Employees", fill = "Gender") +
coord_flip() +
theme(legend.position = "bottom")
}
Q3_4()
# Explanation:
# The analysis revealed that the occupation of meat cutter had the highest number of female workers in Vancouver.
# This observation is in line with the earlier analysis that identified meat cutter as the job role with the highest number of female employees
# who were terminated above the age of 60.
#---- Analysis 3.4 - Identify the job roles with the highest number of female employees in the city, Vancouver ----
Q3_4 <- function() {
# Filter data for Vancouver and group by gender and job title
data_filtered <- data %>%
filter(city_name == "Vancouver", gender == "Female") %>%
group_by(gender, job_title) %>%
summarise(count = n(), .groups = "drop")
# Order job titles by descending count
data_filtered <- data_filtered %>%
arrange(desc(count))
# Plot stacked bar chart
ggplot(data_filtered, aes(x = job_title, y = count, fill = gender)) +
geom_bar(stat = "identity") +
labs(x = "Jobs in Vancouver city", y = "Number of Employees", fill = "Gender") +
coord_flip() +
theme(legend.position = "bottom")
}
Q3_4()
# Explanation:
# The analysis revealed that the occupation of meat cutter had the highest number of female workers in Vancouver.
# This observation is in line with the earlier analysis that identified meat cutter as the job role with the highest number of female employees
# who were terminated above the age of 60.
#---- Analysis 3.4 - Identify the job roles with the highest number of female employees in the city, Vancouver ----
Q3_4 <- function() {
# Filter data for Vancouver and group by gender and job title
data_filtered <- data %>%
filter(city_name == "Vancouver", gender == "Female") %>%
group_by(gender, job_title) %>%
summarise(count = n(), .groups = "drop")
# Order job titles by descending count
data_filtered <- data_filtered %>%
arrange(desc(count))
# Plot stacked bar chart
ggplot(data_filtered, aes(x = job_title, y = count, fill = gender)) +
geom_bar(stat = "identity") +
labs(x = "Jobs in Vancouver city",
y = "Number of Employees",
fill = "Gender") +
# Flip the coordinates of x & y
coord_flip() +
theme(legend.position = "bottom")
}
Q3_4()
# Explanation:
# The analysis revealed that the occupation of meat cutter had the highest number of female workers in Vancouver.
# This observation is in line with the earlier analysis that identified meat cutter as the job role with the highest number of female employees
# who were terminated above the age of 60.
#---- Analysis 4.1 - Find the correlation between employees' generation, job title, and job termination after 2013 ----
Q4_1 <- function() {
termination_count <- data %>%
filter(status == "TERMINATED", status_year >= 2013)
# Plot grouped bar chart
ggplot(termination_count, aes(x = generation, fill = generation)) +
stat_count() +
facet_wrap( ~ job_title) +
labs(x = "Generation", y = "Number of Terminated Employees", fill = "Status") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321", "Gen X" = "#0F2199", "Millennials" = "#AF3376")) +
ggtitle("Employees' Job by Generation")
}
Q4_1()
# Explanation:
# The cashier job appears to be the most commonly terminated position among millennials and gen X, while meat cutter is the most commonly terminated job among baby boomers.
# Additionally, the dairy person job is another position that appears to have a high termination rate among gen X.
# This trend may be attributed to changes in the retail industry and organizational policies, resulting in a decrease in demand for these positions.
# Moreover, employees may have opted for better job opportunities offering higher pay, benefits, and career advancement prospects.
#---- Analysis 4.1 - Find the correlation between employees' generation, job title, and job termination after 2013 ----
Q4_1 <- function() {
termination_count <- data %>%
filter(status == "TERMINATED", status_year >= 2013)
# Plot grouped bar chart
ggplot(termination_count, aes(x = generation, fill = generation)) +
stat_count() +
facet_wrap( ~ job_title) +
labs(x = "Generation", y = "Number of Terminated Employees", fill = "Status") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321", "Gen X" = "#0F2199", "Millennials" = "#AF3376")) +
ggtitle("Employees' Job by Generation")
}
Q4_1()
# Explanation:
# The cashier job appears to be the most commonly terminated position among millennials and gen X, while meat cutter is the most commonly terminated job among baby boomers.
# Additionally, the dairy person job is another position that appears to have a high termination rate among gen X.
# This trend may be attributed to changes in the retail industry and organizational policies, resulting in a decrease in demand for these positions.
# Moreover, employees may have opted for better job opportunities offering higher pay, benefits, and career advancement prospects.
Q4_1 <- function() {
termination_count <- data %>%
filter(status == "TERMINATED", status_year >= 2013)
# Plot grouped bar chart
ggplot(termination_count, aes(x = generation, fill = generation)) +
stat_count() +
facet_wrap( ~ job_title) +
labs(x = "Generation",
y = "Number of Terminated Employees",
fill = "Status") +
scale_fill_manual(values = c("Baby Boomers" = "#DD4321",
"Gen X" = "#0F2199",
"Millennials" = "#AF3376")) +
ggtitle("Employees' Job by Generation")
}
Q4_1()
#---- Analysis 4.2 - Determine the termination reason of different generation employees after 2013 ----
Q4_2 <- function() {
# Filter data for terminated employees after 2013
millennials_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Millennials", job_title == "Cashier", status_year >= 2013)
gen_x_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Gen X", job_title == "Cashier" | job_title == "Dairy Person", status_year >= 2013)
baby_boomers_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Baby Boomers", job_title == "Meat Cutter", status_year >= 2013)
# Count termination reasons
millennials_reason_count <- millennials_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
gen_x_reason_count <- gen_x_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
baby_boomers_reason_count <- baby_boomers_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
# Create pie chart
a <- ggplot(millennials_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Count of terminated Millennial \nCashier employees after 2013") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
b <- ggplot(gen_x_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Termination count of Gen X employees working as Cashiers \nand Dairy Persons after 2013.") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
c <- ggplot(baby_boomers_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Count of terminated Baby Boomers \nMeat Cutter employees after 2013") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
grid.arrange(a, b, c, ncol=3)
}
Q4_2()
# Explanation:
# The high termination rates observed among millennials in the cashier job, gen X in the dairy person and cashier jobs, and baby boomers in the meat cutter job may be attributed to various factors.
# Millennials may have left the cashier job to seek better employment opportunities with improved compensation, benefits, and career growth prospects.
# Gen X may have experienced job loss due to automation and technological advancements in the industry.
# Baby boomers, on the other hand, may have retired due to age or personal preferences for a reduced workload.
#---- Analysis 4.2 - Determine the termination reason of different generation employees after 2013 ----
Q4_2 <- function() {
# Filter data for terminated employees after 2013
millennials_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Millennials", job_title == "Cashier", status_year >= 2013)
gen_x_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Gen X", job_title == "Cashier" | job_title == "Dairy Person", status_year >= 2013)
baby_boomers_termination_count <- data %>%
filter(status == "TERMINATED", generation == "Baby Boomers", job_title == "Meat Cutter", status_year >= 2013)
# Count termination reasons
millennials_reason_count <- millennials_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
gen_x_reason_count <- gen_x_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
baby_boomers_reason_count <- baby_boomers_termination_count %>%
group_by(generation, termination_reason) %>%
summarize(count = n(), .groups = 'drop') %>%
ungroup()
# Create pie chart
a <- ggplot(millennials_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Count of terminated Millennial \nCashier employees after 2013") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
b <- ggplot(gen_x_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Termination count of Gen X employees working as Cashiers \nand Dairy Persons after 2013.") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
c <- ggplot(baby_boomers_reason_count, aes(x = generation, y = count, fill = termination_reason)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_void() +
labs(fill = "Termination Reason") +
ggtitle("Count of terminated Baby Boomers \nMeat Cutter employees after 2013") +
geom_text(aes(label = count), position = position_stack(vjust = 0.5))
grid.arrange(a, b, c, ncol=3)
}
Q4_2()
# Explanation:
# The high termination rates observed among millennials in the cashier job, gen X in the dairy person and cashier jobs, and baby boomers in the meat cutter job may be attributed to various factors.
# Millennials may have left the cashier job to seek better employment opportunities with improved compensation, benefits, and career growth prospects.
# Gen X may have experienced job loss due to automation and technological advancements in the industry.
# Baby boomers, on the other hand, may have retired due to age or personal preferences for a reduced workload.
#---- Analysis 5.1 - Determine the average length of service by year ----
Q5_1 <- function() {
# Filter for terminated employees
term_data <- data %>%
filter(status == "TERMINATED")
# Calculate average length of service by year
service_by_year <- term_data %>%
group_by(status_year) %>%
summarize(avg_service = mean(service_count))
# Plot the line chart
ggplot(service_by_year, aes(x = status_year, y = avg_service)) +
geom_line(color = "blue", size = 1) +
labs(x = "Year", y = "Average length of service (years)",
title = "Average Length of Service for Terminated Employees by Year") +
scale_x_continuous(breaks = seq(min(term_data$status_year), max(term_data$status_year), 1))
}
Q5_1()
# Explanation:
# The trend of the average length of service shows a decline from 2009 to 2011,
# possibly due to the global recession leading to higher termination rates and shorter service periods for terminated employees.
# However, from 2011 to 2015, there was a rapid increase in the average length of service,
# which may be attributed to the economic recovery and increased hiring during that period.
Q5_1 <- function() {
# Filter for terminated employees
term_data <- data %>%
filter(status == "TERMINATED")
# Calculate average length of service by year
service_by_year <- term_data %>%
group_by(status_year) %>%
summarize(avg_service = mean(service_count))
# Plot the line chart
ggplot(service_by_year, aes(x = status_year, y = avg_service)) +
geom_line(color = "blue", size = 1) +
labs(x = "Year",
y = "Average length of service (years)",
title = "Average Length of Service for Terminated Employees by Year") +
scale_x_continuous(breaks = seq(min(term_data$status_year), max(term_data$status_year), 1))
}
Q5_1()
#---- Analysis 5.2 - Find the relationship between average length of service and departments ----
Q5_2 <- function() {
# Group the data by department and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$department_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="palegreen") +
ggtitle("Average Length of Service by Department") +
xlab("Department") +
ylab("Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_2()
# Explanation:
# Based on the graph, it can be observed that the average length of service is the shortest for the customer service department,
# followed by the dairy and processed foods departments.
# This trend may be attributed to the possibility that these departments have a relatively larger number of entry-level positions
# that tend to attract younger and less experienced employees who may be more prone to leaving their jobs sooner.
#---- Analysis 5.2 - Find the relationship between average length of service and departments ----
Q5_2 <- function() {
# Group the data by department and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$department_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="palegreen") +
ggtitle("Average Length of Service by Department") +
labs(x = "Department",
y = "Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_2()
#---- Analysis 5.3 - Find the relationship between average length of service and cities ----
Q5_3 <- function() {
# Group the data by city and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$city_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="magenta") +
ggtitle("Average Length of Service by Department") +
xlab("Department") +
ylab("Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_3()
# Explanation:
# Based on the graph, it can be observed that "Ocean Falls" is the city with the longest average length of service.
# rephrase professionally, " the average length of service in the city "Ocean Falls" is the longest,
# this may be that the company in this city may have a strong presence and good reputation in the community,
# leading to higher job satisfaction and loyalty among employees.
#---- Analysis 5.2 - Find the relationship between average length of service and departments ----
Q5_2 <- function() {
# Group the data by department and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$department_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="palegreen") +
ggtitle("Average Length of Service by Department") +
labs(x = "Department",
y = "Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_2()
# Explanation:
# Based on the graph, it can be observed that the average length of service is the shortest for the customer service department,
# followed by the dairy and processed foods departments.
# This trend may be attributed to the possibility that these departments have a relatively larger number of entry-level positions
# that tend to attract younger and less experienced employees who may be more prone to leaving their jobs sooner.
#---- Analysis 5.3 - Find the relationship between average length of service and cities ----
Q5_3 <- function() {
# Group the data by city and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$city_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="magenta") +
ggtitle("Average Length of Service by Department") +
xlab("Department") +
ylab("Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_3()
# Explanation:
# Based on the graph, it can be observed that "Ocean Falls" is the city with the longest average length of service.
# rephrase professionally, " the average length of service in the city "Ocean Falls" is the longest,
# this may be that the company in this city may have a strong presence and good reputation in the community,
# leading to higher job satisfaction and loyalty among employees.
Q5_3 <- function() {
# Group the data by city and calculate the average length of service
avg_service_dept <- aggregate(data$service, by=list(data$city_name), FUN=mean)
# Plot the bar graph
ggplot(avg_service_dept, aes(x=Group.1, y=x)) +
geom_bar(stat="summary", fun = "mean", fill="magenta") +
ggtitle("Average Length of Service by Department") +
labs(x = "Department",
y = "Average Length of Service") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q5_3()
