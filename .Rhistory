return(z)
}
plus()
#3 Getting values from user
plus<-function(){
x = as.integer(readline(prompt = "Enter the number:"))
y = as.integer(readline(prompt = "Enter the number:"))
z = x + y
return(z)
}
plus()
calculator <- function(x,y)
{
add = x + y
sub = x - y
mul = x * y
div = x / y
return(c(Addition=add,subtraction=sub,Multiply=mul,Division=div))
}
calculator(20,20)
# Practice Problem
# Create a function called getdetails() and accept name,id,Mark1,Mark2 of one student
# and print all these data along with Total marks and Average.
details <- function(){
name = readline(prompt = "Your name:")
id = as.integer(readline(prompt = "Your ID:"))
mark1 = as.integer(readline(prompt = "Your mark1:"))
mark2 = as.integer(readline(prompt = "Your mark2:"))
total = mark1 + mark2
avg = total / 2
return(c(Name=name,ID=id,Mark1=mark1,Mark2=mark2,"Total Marks"=total,Average=avg))
}
details
# FUNCTIONS
#   func_name <- function (arguments)
#   {
#      // statements
#      //return(value)
#   }
# Create function called "display" and print "welcome"
display <- function(){
print("Welcome")
}
display()
# Create a function for sum of two numbers by passing through parameters
plus<-function(x, y){
z = x + y
return (z)
}
plus(34, 56)
#2 Assigning Directly
plus<-function()
{
x = 34
y <- 56
z = x + y
return(z)
}
plus()
#3 Getting values from user
plus<-function(){
x = as.integer(readline(prompt = "Enter the number:"))
y = as.integer(readline(prompt = "Enter the number:"))
z = x + y
return(z)
}
plus()
calculator <- function(x,y)
{
add = x + y
sub = x - y
mul = x * y
div = x / y
return(c(Addition=add,subtraction=sub,Multiply=mul,Division=div))
}
calculator(20,20)
# Practice Problem
# Create a function called getdetails() and accept name,id,Mark1,Mark2 of one student
# and print all these data along with Total marks and Average.
details <- function(){
name = readline(prompt = "Your name:")
id = as.integer(readline(prompt = "Your ID:"))
mark1 = as.integer(readline(prompt = "Your mark1:"))
mark2 = as.integer(readline(prompt = "Your mark2:"))
total = mark1 + mark2
avg = total / 2
return(c(Name=name,ID=id,Mark1=mark1,Mark2=mark2,"Total Marks"=total,Average=avg))
}
details()
clear
# FUNCTIONS
#   func_name <- function (arguments)
#   {
#      // statements
#      //return(value)
#   }
# Create function called "display" and print "welcome"
display <- function(){
print("Welcome")
}
display()
# Create a function for sum of two numbers by passing through parameters
plus<-function(x, y){
z = x + y
return (z)
}
plus(34, 56)
#2 Assigning Directly
plus<-function()
{
x = 34
y <- 56
z = x + y
return(z)
}
plus()
#3 Getting values from user
plus<-function(){
x = as.integer(readline(prompt = "Enter the number:"))
y = as.integer(readline(prompt = "Enter the number:"))
z = x + y
return(z)
}
plus()
calculator <- function(x,y)
{
add = x + y
sub = x - y
mul = x * y
div = x / y
return(c(Addition=add,subtraction=sub,Multiply=mul,Division=div))
}
calculator(20,20)
# Practice Problem
# Create a function called getdetails() and accept name,id,Mark1,Mark2 of one student
# and print all these data along with Total marks and Average.
details <- function(){
name = readline(prompt = "Your name: ")
id = as.integer(readline(prompt = "Your ID: "))
mark1 = as.integer(readline(prompt = "Your mark1: "))
mark2 = as.integer(readline(prompt = "Your mark2: "))
total = mark1 + mark2
avg = total / 2
return(c(Name=name,ID=id,Mark1=mark1,Mark2=mark2,"Total Marks"=total,Average=avg))
}
details()
# FUNCTIONS
#   func_name <- function (arguments)
#   {
#      // statements
#      //return(value)
#   }
# Create function called "display" and print "welcome"
display <- function(){
print("Welcome")
}
display()
# Create a function for sum of two numbers by passing through parameters
plus<-function(x, y){
z = x + y
return (z)
}
plus(34, 56)
#2 Assigning Directly
plus<-function()
{
x = 34
y <- 56
z = x + y
return(z)
}
plus()
#3 Getting values from user
plus<-function(){
x = as.integer(readline(prompt = "Enter the number:"))
y = as.integer(readline(prompt = "Enter the number:"))
z = x + y
return(z)
}
plus()
calculator <- function(x,y)
{
add = x + y
sub = x - y
mul = x * y
div = x / y
return(c(Addition=add,subtraction=sub,Multiply=mul,Division=div))
}
calculator(20,20)
# Practice Problem
# Create a function called getdetails() and accept name,id,Mark1,Mark2 of one student
# and print all these data along with Total marks and Average.
details <- function(){
name = readline(prompt = "Your name: ")
id = as.integer(readline(prompt = "Your ID: "))
mark1 = as.integer(readline(prompt = "Your mark1: "))
mark2 = as.integer(readline(prompt = "Your mark2: "))
total = mark1 + mark2
avg = total / 2
return(c(Name=name,ID=id,Mark1=mark1,Mark2=mark2,"Total Marks"=total,Average=avg))
}
details
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv")
sample_data
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
head(sample_data, 10)
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
head(sample_data, 10)
take(sample_data, 10)
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
head(sample_data, 10)
tail(sample_data, 10)
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
head(sample_data, 10)
tail(sample_data, 10)
# View all data
view(sample_data)
# Data Exploration
# Import data
# Cleaning data
# Pre-processing
# Data exploration
# Data visualization
# Data manipulation
# Read file
sample_data = read.csv("C:\\Users\\bbkx2\\Downloads\\IRIS.csv",header=FALSE)
sample_data
# Reassigning Headers
names(sample_data) = c("SEPAL_LENGTH","SEPEL_WIDTH","PETAL_LENGTH","PETAL_WIDTH","SPECIES")
sample_data
head(sample_data)
head(sample_data, 10)
tail(sample_data, 10)
# View all data
sample_data
View(sample_data)
dataExploration <- function(data) {
# Check number of columns
cat("The total no. of columns is", ncol(data),"and the total no. of rows is", nrow(data),"\n")
# Check number of missing values
cat("The number of missing values in data:", sum(is.na(data)), "\n\n")
# Check data structure
cat(str(data), "\n")
# Check summary of the data
print(summary(data))
}
#---- Load packages ----
library(dplyr)
library(ggplot2)
library(magrittr)
library(stringr)
library(tidyverse)
library(lubridate)
library(gridExtra)
library(plotrix)
library(openair)
library(ggrepel)
# Import data by reading csv file
setwd("C:/Users/bbkx2/Downloads/project/R/PFDA_Assignment")
data <- read.csv('employee_attrition.csv', header = TRUE, sep = ",")
# Data Exploration
# This function takes in the data and displays the number of columns and rows in the data,
# the number of missing values in the data, the data structure, and the summary of the data
# @param data: The data to be explored
dataExploration <- function(data) {
# Check number of columns
cat("The total no. of columns is", ncol(data),"and the total no. of rows is", nrow(data),"\n")
# Check number of missing values
cat("The number of missing values in data:", sum(is.na(data)), "\n\n")
# Check data structure
cat(str(data), "\n")
# Check summary of the data
print(summary(data))
}
# Data Cleaning
# This code is used to clean the data by removing duplicates, replacing missing values,
# removing unnecessary columns, renaming columns, and returning the cleaned data.
# @param data: The data to be cleaned
dataCleaning <- function(data) {
# Check for duplicates
sum(duplicated(data))
# If there's any, remove the duplicates
unique(data)
# Replace missing values with NA, if any
data[data == ""] <- NA
# Remove unnecessary column
data <- select(data, -c("gender_short"))
# Renaming column names
colnames(data) <- c("employee_ID", "record_date", "birth_date", "hired_date", "termination_date",
"age", "service_count", "city_name", "department_name", "job_title",
"store_name", "gender", "termination_reason", "termination_type", "status_year",
"status", "business_unit")
return(data)
}
# Data Pre-processing
# This function pre-processes the input data by cleaning and transforming it.
# Finally, it returns the pre-processed data.
# @param data: The data to be processed
dataPreprocessing <- function(data) {
# Replace default termination date (still working) to "NA"
data$termination_date = ifelse(data$termination_date == "1/1/1900", NA, data$termination_date)
# Converted to POSIXct (a date/time data type in R) using the specified date format strings
data$record_date <- as.POSIXct(data$record_date, format = "%m/%d/%Y %H:%M")
data$birth_date <- as.POSIXct(data$birth_date, format = "%m/%d/%Y")
data$hired_date <- as.POSIXct(data$hired_date, format = "%m/%d/%Y")
data$termination_date <- as.POSIXct(data$termination_date, format = "%m/%d/%Y")
# Replace typo "resignaton" to "resignation"
data$termination_reason <- str_replace(data$termination_reason, "Resignaton", "Resignation")
# Splits the job title string (e.g <Director, Any> to <Director> only) by the comma character
# and returns the first element of the resulting string vector
data$job_title <- sapply(data$job_title, function(f) {strsplit(f, ",")[[1]]}[1])
# Converted job title to character format
data$job_title <- as.character(data$job_title)
# Converted character type data into factor
data <- data %>%
mutate(
employee_ID = as.factor(employee_ID),
city_name = as.factor(city_name),
department_name = as.factor(department_name),
job_title = as.factor(job_title),
store_name = as.factor(store_name),
gender = as.factor(gender),
termination_reason = as.factor(termination_reason),
termination_type = as.factor(termination_type),
status = as.factor(status),
business_unit = as.factor(business_unit)
)
# Extract the year from the birth date
data$birth_year <- year(ymd(data$birth_date))
# This code creates a new variable generation based on the birth_year variable
# The generation variable categorizes the different birth years into five different groups
# The first group is the Silent Generation, the second group is the Baby Boomers,
# the third group is Gen X, the fourth group is the Millennials and the fifth group is Gen Z
data$generation <- ifelse(data$birth_year >= 1997, "Gen Z",
ifelse(data$birth_year >= 1981, "Millennials",
ifelse(data$birth_year >= 1965, "Gen X",
ifelse(data$birth_year >= 1946, "Baby Boomers", "The Silent Generation"))))
return(data)
}
# Explore, Clean, and Pre-process the data all at once
# The data is first explored and then cleaned and preprocessed.
dataExploration(data)
data <- data %>%
dataCleaning() %>%
dataPreprocessing()
#---- Analysis 3.4 - Identify the job roles with the highest number of female employees in the city, Vancouver ----
Q3_4 <- function() {
# Filter data for Vancouver and group by gender and job title
data_filtered <- data %>%
filter(city_name == "Vancouver", gender == "Female") %>%
group_by(gender, job_title) %>%
summarise(count = n(), .groups = "drop")
# Order job titles by descending count
data_filtered <- data_filtered %>%
arrange(desc(count))
# Plot stacked bar chart
ggplot(data_filtered, aes(x = job_title, y = count, fill = gender)) +
geom_bar(stat = "identity") +
labs(x = "Jobs in Vancouver city",
y = "Number of Employees",
fill = "Gender") +
# Flip the coordinates of x & y
coord_flip() +
theme(legend.position = "bottom")
}
Q3_4()
# Explanation:
# The analysis revealed that the occupation of meat cutter had the highest number of female workers in Vancouver.
# This observation is in line with the earlier analysis that identified meat cutter as the job role with the highest number of female employees
# who were terminated above the age of 60.
#---- Analysis 3.3 - Find the relationship between city and employees' termination ----
Q3_3 <- function() {
# Filter out the year of termination date
data$termination_year <- year(ymd(data$termination_date))
# Filter the data that only applicable for those who terminated in 2014 & 2015
data_filtered <- data %>%
filter(status == "TERMINATED", termination_year %in% c(2014, 2015))
# Counting terminated employees by gender and city
terminated_by_city <- data_filtered %>%
group_by(gender, city_name) %>%
summarise(count = n(), .groups = "drop")
# Plotting the graph
ggplot(terminated_by_city, aes(x = city_name, y = count, fill = gender)) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = "City",
y = "Count of Terminated Employees",
fill = "Gender") +
ggtitle("Distribution of Terminated Employees by City and Gender") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
Q3_3()
# Explanation:
# According to the graph, Vancouver had the highest number of terminated female employees.
# This may be attributed to a possible decline in the industries where female employees were more represented in Vancouver, resulting in higher termination rates.
#---- Analysis 3.1 - Find the correlation between the age of the employee and the likelihood of termination by gender ----
Q3_1 = function() {
# Filter out the year of termination date
data$termination_year <- year(ymd(data$termination_date))
# Filter the data that only applicable for those who terminated in 2014 & 2015
data_2014_2015 <- data %>%
filter(termination_year %in% c(2014, 2015), status == "TERMINATED")
# Create the histogram for females
female_data <- subset(data_2014_2015, gender == "Female")
female_hist <- ggplot(female_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Female Employee Termination by Age and Reason",
x = "Age",
y = "Frequency")
# Create the histogram for males
male_data <- subset(data_2014_2015, gender == "Male")
male_hist <- ggplot(male_data, aes(x = age, fill = termination_reason)) +
geom_histogram(binwidth = 2, color = "black", width = 1) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Male Employee Termination by Age and Reason",
x = "Age", y = "Frequency")
# Combine the histograms to show them all in a graph
grid.arrange(female_hist, male_hist, ncol = 2)
}
Q3_1()
# Explanation
# There is a higher likelihood for older female employees to retire compared to older male employees,
# and no retirement occurred for male employees in 2014 and 2015.
# This trend may be attributed to the fact that old female employees are more likely to be employed in job roles
# that have different retirement patterns compared to those of male employees.
